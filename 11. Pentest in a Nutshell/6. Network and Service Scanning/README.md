<h3>Network and Service Scanning</h3>

Network and service scanning is a foundational step in penetration testing and security assessments. It involves identifying active hosts, open ports, and running services within a defined scope, and is used to gain a comprehensive understanding of the target environment. Network Mapper (Nmap) is the most widely used tool for this purpose, due to its versatility, accuracy, and extensive feature set. By scanning the network, testers can map the attack surface, identify potential vulnerabilities, and prioritize targets for further analysis. This section explores the process of network scanning, provides a practical example using Nmap, and explains how the results can be leveraged to identify "low-hanging fruits"—easily exploitable vulnerabilities or misconfigurations.

<h3>Understanding the Assigned Scope</h3>

Before initiating a scan, it is critical to define and understand the scope of the assessment. The scope typically includes a range of IP addresses, domains, or systems that the client has authorized for testing. For example, a scope might consist of a single subnet, such as 10.129.12.0/24, which encompasses all IP addresses from 10.129.12.0 to 10.129.12.255. Understanding the scope ensures that testing remains within legal and ethical boundaries and focuses on the systems relevant to the client’s objectives.

The primary goal of network scanning is to identify active hosts within the scope and determine the services they expose. Active hosts are systems that respond to network probes, indicating they are online and potentially part of the target environment. Services, on the other hand, are applications or protocols running on specific ports, such as HTTP (port 80), SSH (port 22), or SMB (port 445). By mapping these services, we can infer the purpose of each system, its role in the network, and potential attack vectors.

Next, we will start enumerating the network. Therefore, follow up the commands from here on Pwnbox. You will see many different tools to be used. Do not be afraid to experiment and try different techniques. You will learn those tools in detail later.

<h3>Using Nmap for Network Scanning</h3>

Nmap is a powerful, open-source tool designed for network discovery and security auditing. It supports a wide range of scanning techniques, from simple ping scans to advanced service enumeration and vulnerability detection. Nmap’s flexibility allows testers to tailor scans to specific objectives, such as identifying open ports, detecting operating systems, or scripting custom probes. The Network Enumeration with Nmap will teach you in detail how to enumerate and gather all the information of a network or host.

Let’s consider a practical example of scanning the 10.129.12.0/24 network that's been assigned to us, which contains only two hosts. To perform the scan, we can use the following Nmap command:

nmap -sV -p- 10.129.12.0/24 -oA network-scan

sV: Enables service version detection, which attempts to identify the software and version running on each open port.

-p-: Scans all 65,535 ports (both TCP and UDP) to ensure no services are missed.

-oA network-scan: Save the results of the scan to a file called "network-scan".

10.129.12.0/24: Specifies the target network range.

Assuming the scan identifies the two hosts, the output might look like this (simplified for clarity):

@htb[/htb]$ nmap -sV -p- 10.129.12.0/24 -oA network-scan

Starting Nmap 7.94 ( <https://nmap.org> )

Nmap scan report for 10.129.12.10

Host is up (0.0012s latency).

PORT STATE SERVICE VERSION

21/tcp open ftp ProFTPD

22/tcp open ssh OpenSSH 8.9p1 Ubuntu 3ubuntu0.7 (Ubuntu Linux; protocol 2.0)

80/tcp open http nginx 1.18.0 (Ubuntu)

443/tcp open ssl/http Apache httpd 2.4.52 ((Ubuntu))

8000/tcp open ssl/http Golang net/http server (Go-IPFS json-rpc or InfluxDB API)

8001/tcp open ssl/vcom-tunnel?

8080/tcp open http Apache httpd 2.4.52 ((Ubuntu))

8889/tcp open ssl/http Golang net/http server

Nmap scan report for 10.129.12.20

Host is up (0.0015s latency).

PORT STATE SERVICE VERSION

22/tcp open ssh OpenSSH for_Windows_9.5 (protocol 2.0)

135/tcp open msrpc Microsoft Windows RPC

139/tcp open netbios-ssn Microsoft Windows netbios-ssn

445/tcp open microsoft-ds Windows Server 2019 Standard 17763 microsoft-ds

3000/tcp open http Golang net/http server

3389/tcp open ms-wbt-server Microsoft Terminal Services

5357/tcp open http Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)

5985/tcp open http Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)

5986/tcp open ssl/http Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP
)
8000/tcp open ssl/http Golang net/http server (Go-IPFS json-rpc or InfluxDB API)

8889/tcp open ssl/http Golang net/http server

49669/tcp open msrpc Microsoft Windows RPC

Nmap done: 256 IP addresses (2 hosts up) scanned in 12.34 seconds

<h3>Interpreting the Scan Results</h3>

The Nmap output provides a detailed snapshot of the network, highlighting the active hosts and their open ports. Let’s break down the results for each host:

<h4> 10.129.12.10</h4>

Port 21 (FTP): Running vsftpd 3.0.3, a popular FTP server. FTP is often a target for attacks due to weak authentication mechanisms or misconfigurations.

Port 22 (SSH): Running OpenSSH 8.2p1. SSH is a secure protocol, but vulnerabilities in older versions or weak credentials could be exploited.

Port 80 (HTTP): Hosting an Apache httpd 2.4.41 web server. Web servers are common attack vectors, especially if they host vulnerable applications or misconfigured settings.

Port 443 (HTTPS): Also running Apache httpd 2.4.41 with SSL/TLS. HTTPS services may be vulnerable to SSL/TLS misconfigurations or outdated cipher suites.

Port 4369 (Erlang Port Mapper Daemon): Used by Erlang-based applications. This service is less common and may indicate a specialized application, potentially misconfigured or vulnerable.

<h4> 10.129.12.20</h4>

Port 22 (SSH): Running OpenSSH for Windows 9.5. SSH provides secure remote access, though Windows-specific implementations may have unique security considerations.

Port 139 (NetBIOS): A legacy protocol used for file sharing and printer services. It is often targeted in attacks due to historical vulnerabilities.

Port 445 (SMB): Running Microsoft’s Server Message Block protocol, critical for file sharing in Windows environments. SMB has been a target for major exploits like EternalBlue.

Port 3000 (HTTP): Running a Golang net/http server. Web applications on non-standard ports may indicate internal services or development environments that require security review.

Port 3389 (RDP): Microsoft’s Remote Desktop Protocol, used for remote administration. RDP is frequently targeted for brute-force attacks or exploits if not properly secured.

<h3>Leveraging the Results</h3>

The scan results provide a great overview for further testing. Testers can prioritize targets based on the identified services and their associated risks. For example:

1. Vulnerability Scanning: Use tools like Nessus or OpenVAS to scan for known vulnerabilities in the identified software versions.

2. Credential Testing: Attempt brute-force attacks on services like FTP, SSH, and RDP to test for weak passwords.

3. Configuration Analysis: Review the configuration of web servers (ports 80/443) and message brokers (port 8161) for misconfigurations, such as default credentials or insecure settings.

4. Exploit Testing: If vulnerabilities are identified, attempt to exploit them using frameworks like Metasploit to assess their impact.

By systematically analyzing the scan results and focusing on low-hanging fruits, testers can efficiently identify and address critical vulnerabilities, improving the overall security posture of the target environment.

<h3>Note Taking</h3>

Thorough note-taking is essential. You should write down everything you do, including all commands you run and everything you find. This has several benefits. It allows your team members to check your work and understand the actions you took. Write down exactly which commands you used, when you used them, and what happened. For example, if you ran an Nmap scan, write down the exact command you typed and what the results were, including any error messages.

Additionally, good notes help you keep track of what you're doing. When you find something interesting, like a possible “low hanging fruit” (that we will discuss next), write down:

- What you found

- Why you thought it was important

- What made you decide to look into it further

Third, having quality notes will make it much easier for you to write your final report. If you keep clear, organized notes during your work, you can easily:

- Find specific problems you discovered
- Show proof of security weaknesses
- Explain exactly how you found each problem.

It's helpful to include screenshots and the results of commands you ran that led to important discoveries.

Keep your notes organized and easy to read. Use clear headings and a consistent format. The markdown format is recommended since it allow easy and quick styling. You can use tools like Notion, OneNote, or special security testing tools to help organize your notes. Remember to include the date and time for everything you do, and list any outside tools or resources you used.
