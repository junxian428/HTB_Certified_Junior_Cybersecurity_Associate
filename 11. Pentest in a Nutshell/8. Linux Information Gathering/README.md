<h3>Linux Information Gathering</h3>

Next, we will perform additional information gathering and assess the collected data for vulnerabilities on the Ubuntu Linux target. These two stages go hand in hand. If we don't know what aspects of the target or its services to test, then we haven't gathered enough information. In that case, we need to step back and learn more about the services provided—their functions, purposes, the problems they solve, and how they are used.

<img width="976" height="368" alt="image" src="https://github.com/user-attachments/assets/e8e89b9c-c81d-4185-8e10-a4a572dd9b2b" />

Let’s take another look at our initial findings. We've identified:

- Operating System: Ubuntu Linux

- File sharing: FTP on 21

- Remote Access: SSH on 22

- Web Server: WordPress 6.7.2

- Domain: cube-case.htb

<h3>FTP</h3>

When dealing with FTP service, we can use the ftp client on our Pwnbox to connect to the target using the File Transfer Protocol (FTP).

FTP is a basic method for moving files between computers over a network—think of it as a digital courier service. It allows you to upload files to a remote computer (like sending packages) or download files from it (like receiving packages). As one of the oldest and simplest methods for sharing files over the internet, FTP acts as a bridge between two computers for data transfer. However, it's important to note that, in its basic form, FTP transmits data without encryption, making it unsuitable for transferring sensitive files securely.

When using the ftp client, we must specify the IP address and port to connect to—similar to providing a package carrier with a street address and house number. Since our Nmap results indicate that anonymous login is enabled, we can log in as anonymous to explore further. The FTP service will prompt us for a username and password, which, by default, are anonymous:whatever. The commands would look like the following:

@htb[/htb]$ ftp 10.129.12.10 21

Connected to 10.129.12.10.

Once we're logged in, we can use the ls command to list all visible files within the default directory configured for the FTP service.

ftp> ls

Here, we see that there is a file called WordPress_Blog_Setup_Update.txt, which might contains some interesting data for us. We also see that the file is owned by the user john . After we add these findings to our notes, we download the file using the get <filename> command. We will take a closer look at it once we're finished with the FTP server.

ftp> get WordPress_Blog_Setup_Update.txt

Now, we can use the ls -al command which lists not only the visible files but also hidden files and directories. Let’s run the command and see what we get.

ftp> ls -al

At this point, we see many hidden files and directories. If you have worked with Linux systems before, you will notice that it seems to be the home directory of a user (most likely john, based on the file permissions). Each of these files could contain important information for us, but first we will download the .bash_history file (which can reveal the existence of certain programs, files, directories, access, and more.)

ftp> get .bash_history

Another potential goldmine is the .ssh directory. This directory (most of the time) is used to store files related to SSH, such as private keys, configs, and more. From those files, we could identify other machines/targets for remote access, or possibly obtain a private key that could be used gain remote access to the current target. Therefore, let’s use the cd command to change directory to .ssh and list all files within it.

ftp> cd .ssh

250 CWD command successful

ftp> ls -al

As you can see, there are two files in it - id_rsa and id_rsa.pub . When SSH keys are generated, and the user doesn’t modify them, these names are used by default. The id_rsa and id_rsa.pub files are a pair of SSH keys used for authentication:

id_rsa is the private key that should be kept secret and never shared

id_rsa.pub is the public key that can be shared with other systems

These keys work together like a lock and key. The public key (id_rsa.pub) is installed on remote machines you want to connect to, while the private key (id_rsa) on your local machine proves your identity. Now, let’s download the private key and exit the FTP connection.

ftp> get id_rsa

On Pwnbox, we can now check all the files we have downloaded by using ls -l.

@htb[/htb]$ ls -l

First, let’s see what the WordPress Blog Setup Update file says:

@htb[/htb]$ cat WordPress_Blog_Setup_Update.txt

From a cybersecurity perspective, this file reveals several pieces of information that we should make a note of:

- It confirms the existence of a temporary FTP server that was set up for internal use during WordPress setup but is exposed

- It mentions "temporary access credentials", suggesting there might be default or weak credentials still in place (anonymous login enabled)

- It confirms the presence of an incomplete WordPress installation, which could mean security configurations are not fully implemented (Sample page)

- The message contains an employee name (John Doe) and indicates he's part of the Development Team

- It reveals internal processes and project status, which could be useful for social engineering attacks

In general, this kind of internal communication shouldn't be accessible through FTP, as it provides with valuable information about the system's setup and potential vulnerabilities during this transition period.

Next, let’s take a look at the .bash_history file. The .bash_history file is a hidden file in Linux/Unix systems that by default, keeps a record of all commands previously entered by a user in the Bash shell. Each time a user enters a command in their terminal, it gets logged to this file. This historical record can be very valuable from a security perspective as it may contain:

- Commands that reveal sensitive operations or configurations

- Usernames, passwords, or other credentials that were typed directly into the command line

- Information about system structure, file locations, and installed programs

- Evidence of file operations, installations, or system modifications

By default, Bash saves the last 500-1000 commands in this file, though this number can be configured.

@htb[/htb]$ cat .bash_history

<SNIP>
  
sudo rm -f /tmp/old_log.txt

When reviewing the file, we notice that the password for the user john was changed. These credentials might be outdated, but they could also still work, so we can test them later. First, let's examine the SSH private key

@htb[/htb]$ cat id_rsa

Most of the time, administrators protect their private keys from usage with a password. While generating such a private key, administrators have the option to encrypt it with a password which will require them to enter the correct password before the private key is applied for authentication. In such a case, where the SSH private key is protected would look like following:

-----BEGIN RSA PRIVATE KEY-----

Proc-Type: 4,ENCRYPTED

DEK-Info: AES-256-CBC,5F2B1C4D6E7A8B9C0D1E2F3A4B5C6D7E

MIIEpAIBAAKCAQEAqkN6H2rKkQ92FxQnZf0tqK3d2T3N5X1zjUoL1F1g0J9sKxYz

<SNIP>
  
aB4eR6qL2nP1mJ8sV3rQ0kL9fT2pG7mR0cQ2sV4dN1rO8xZ5vT6aC9dP3lK4bY2sH

-----END RSA PRIVATE KEY-----

However, in our case the private key is not password protected and might be used for authentication. Let's summarize our key findings from the FTP service:

<h3>Access and Environment</h3>

- Anonymous FTP access was enabled on port 21

- We identified this as a home directory for user john

- Several important configuration and history files were accessible

- .bash_history file revealed potential credentials: john:SuperSecurePass123

- SSH private key (id_rsa) was obtained and is not password protected

- WordPress setup documentation revealed temporary FTP configuration

<h3>Security Implications</h3>

- Exposed SSH private key could allow unauthorized system access

- FTP server was intended to be temporary but remained accessible

- Internal documentation exposed system configuration details

- Command history revealed sensitive operations and potential credentials

These findings provide multiple potential attack vectors, particularly through SSH access using either the discovered credentials or the unprotected private key. Next, let’s focus on WordPress.

<h3>WordPress</h3>

Since we are dealing with WordPress — a very popular CMS — we can use a tool called wpscan. WPScan is a security tool designed to scan WordPress websites for valuable information and vulnerabilities. It automatically detects security issues, identifies weak spots in WordPress itself, and examines any installed plugins or themes for vulnerabilities. It can also enumerate usernames and test for weak passwords.

Let's run WPScan on the target. We'll enumerate plugins (-e p), skip TLS checks (--disable-tls-checks), set the plugin detection mode to passive (--plugins-detection passive), and use 100 threads (-t 100) to speed up the enumeration.

@htb[/htb]$ wpscan -e p --url https://10.129.12.10 --disable-tls-checks --no-banner --plugins-detection passive -t 100

[+] URL: <https://cube-case.htb/> [10.129.12.10]

[+] Started: Sat Feb 15 15:34:53 2025

Now, we've obtained some very useful information from WordPress that we should add to our documentation:

Server Information: Apache/2.4.52 (Ubuntu)

WordPress version confirmed: WordPress 6.7.2

XML-RPC: Enabled and accessible

Theme: twentytwentyfive v1.0

Plugin: hash-form v1.1.0

As a side note, we also provide a Hacking WordPress that focuses on WordPress CMS only.

At this point, we can start the Metasploit Framework (with the msfconsole -q command) to search for known vulnerabilities, and see if any of them would apply to the plugin version we have discovered.

@htb[/htb]$ msfconsole -q

msf6> search wordpress hash form

In this output, we can see that we have found an exploit for the WordPress Hash Form Plugin that seems to be vulnerable to a remote code execution (RCE). Let’s take a closer look at the exploit and check if the plugin version from our target is vulnerable to that exploit. To accomplish this, we can use the command info with the appropriate index 0.

msf6 exploit(multi/http/wp_hash_form_rce) > info 0


The description states exploit works for all versions before and including the version 1.1.0, which is the same as we have on our target.

We have prepared a module called Footprinting that goes in-depth for the most used services and teaches many different techniques to gather necessary information. Additionally, you also can find a module about Using the Metasploit Framework that teaches you how to utilize it efficiently.

<img width="981" height="554" alt="image" src="https://github.com/user-attachments/assets/9fc7dccf-3532-4a39-8b9d-bfd475898e93" />

Let’s summarize all of our findings for the target and note them down:

<h3>FTP</h3>

- Access and Environment

- Anonymous FTP access was enabled on port 21

- We identified this as a home directory for user john

- Several important configuration and history files were accessible

<h3>Critical Files</h3>

- .bash_history file revealed potential credentials: john:SuperSecurePass123

- SSH private key (id_rsa) was obtained and is not password protected

- WordPress setup documentation revealed temporary FTP configuration

<h3>Security Implications</h3>

- Exposed SSH private key could allow unauthorized system access

- FTP server was intended to be temporary but remained accessible

- Internal documentation exposed system configuration details

- Command history revealed sensitive operations and potential credentials

<h3>WordPress</h3>

- Running WordPress version 6.7.2 (Latest version)

- Server: Apache/2.4.52 (Ubuntu)

- XML-RPC enabled and accessible

- Theme: twentytwentyfive v1.0

- Plugin: hash-form v1.1.0 - vulnerable to RCE (CVE-2024-5084)

As a result, we have several pieces of data that could provide access on our target. In the next section, we will test them out.

